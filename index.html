<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Court Typing Exam – Practice</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  background: #f4f6f8;
  font-family: "Times New Roman", Times, serif;
  color: #000;
}

/* HEADER */
header {
  background: #1f2937;
  color: #fff;
  padding: 12px 24px;
  font-size: 17px;
  font-weight: bold;
  display: flex;
  justify-content: space-between;
}
#timer { color: #fde68a; }

/* PAGE */
.page {
  max-width: 900px;
  margin: 30px auto;
  background: #fff;
  padding: 40px;
  border: 1px solid #cbd5e1;
}

/* PASSAGE / RESULT TEXT */
#textPanel {
  font-size: 18px;
  line-height: 1.9;
  white-space: pre-wrap;
  margin-bottom: 30px;
}

/* TYPING AREA (A4 FEEL) */
#typingArea {
  width: 100%;
  height: 650px;
  font-family: "Times New Roman", Times, serif;
  font-size: 18px;
  line-height: 1.9;
  border: 1px solid #000;
  padding: 30px;
  resize: none;
  outline: none;
  display: none;
}

/* CONTROLS */
.controls {
  margin-top: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

select, button {
  font-family: inherit;
  font-size: 15px;
  padding: 6px 12px;
}

button {
  border: 1px solid #000;
  background: #e5e7eb;
  cursor: pointer;
}

button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* RESULT SUMMARY */
#resultBox {
  margin-top: 40px;
  border: 1px solid #000;
  padding: 20px 30px;
  display: none;
}

#resultBox h3 {
  margin: 0 0 15px 0;
  border-bottom: 1px solid #000;
  padding-bottom: 8px;
}

.summary-row {
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
}

/* HIGHLIGHTS */
.correct { color: #15803d; font-weight: bold; }
.wrong { color: #b91c1c; font-weight: bold; }
.correct-word { color: #374151; margin-left: 4px; }
.omitted { text-decoration: line-through; }
.blur { text-decoration: line-through; opacity: 0.4; }
</style>
</head>

<body>

<header>
  COURT TYPING EXAM – PRACTICE
  <span id="timer">Time Left: 10:00</span>
</header>

<div class="page">

  <div id="textPanel">
    Select a passage and read it carefully. It will disappear once the test starts.
  </div>

  <textarea id="typingArea" placeholder="Type here exactly as memorized..."></textarea>

  <div class="controls">
    <div>
      Passage:
      <select id="passageSelect">
        <option value="">-- Select --</option>
        <option value="0">Passage 1</option>
        <option value="1">Passage 2</option>
      </select>

      Time:
      <select id="timeSelect">
        <option value="600">10 Minutes</option>
        <option value="900">15 Minutes</option>
      </select>
    </div>

    <div>
      <button id="startBtn">Start Test</button>
      <button id="submitBtn" disabled>Submit</button>
    </div>
  </div>

  <div id="resultBox"></div>

</div>

<script>
"use strict";

/* PASSAGES */
const passages = [
`We have all been there busy with our jobs and taking care of our families; we have to-do lists a mile long. If we are lucky, when we stumble into bed at night, we might have crossed off a handful of tasks. We have trouble sleeping as we think about all of the things we failed to do. For some reason, in the middle of the night, the size of these tasks is exaggerated. When we get up the next day, we are sleep deprived and racked with guilt, ready to begin yet another day of being behind. This vicious cycle goes on day after day, month after month, year after year. In this age of 24/7 connectivity, if we take a “vacation,” we continue to do work, and if we don’t, we feel guilty.

The fatigue, disorganization, and sense of loss of control usually leads to reduced productivity and quality of our efforts, both professional and personal. The stress and anxiety take up valuable time and energy. Anxiety eats brainpower. How do we break this cycle? Learning to manage our time, instead of allowing time to manage us, is the key. There are many time management and organization books and other resources. Unfortunately, many make the reader feel guilty, because it is difficult to complete all of the suggested tasks. If you feel guilty and try to adhere to someone else’s style, you are likely to become frustrated. If you find something that works for you, you will feel good about whatever you are able to accomplish and forge ahead.

For example, most authors stress the need for filing. This is great if you have a simple filing scheme and have someone to do the filing for you. Otherwise, filing is a time-consuming task that is difficult to maintain over time. From Morgenstern, I learned that my method of “organized piles” is perfectly acceptable as long as I can find items easily.

Instead of feeling like a filing failure, I feel successful in my maintenance of orderly heaps. Time management is one of the most rewarding skills that will take you far in your life both personal and professional. If you aren’t managing your time effectively, sooner or later you would enter into the state of pandemonium. Time, being such a crucial aspect of life, deserves to be treated in the most respectful manner. Only if we learn to master the art of time management, our life would experience a positive change.`,

`The role of law in society is to establish order and protect rights. Courts interpret statutes, resolve disputes, and ensure justice is delivered fairly and efficiently.`
];

/* STATE */
let timeLeft = 0;
let timer = null;
let mode = "view";
let keystrokes = 0;

/* ELEMENTS */
const textPanel = document.getElementById("textPanel");
const typingArea = document.getElementById("typingArea");
const timerSpan = document.getElementById("timer");
const startBtn = document.getElementById("startBtn");
const submitBtn = document.getElementById("submitBtn");
const resultBox = document.getElementById("resultBox");

/* UTIL */
function splitWords(t){ return t.trim().split(/\s+/); }

/* ALIGNMENT LOGIC (UNCHANGED) */
function alignAndClassify(given, typed){
  let res=[], i=0, j=0;
  while(j<typed.length && i<given.length){
    if(typed[j] === given[i]){
      res.push({t:"c", g:given[i]}); i++; j++;
    } else if(i+1 < given.length && typed[j] === given[i+1]){
      res.push({t:"o", g:given[i]}); i++;
    } else {
      res.push({t:"w", g:given[i], u:typed[j]}); i++; j++;
    }
  }
  while(j<typed.length){
    res.push({t:"w", u:typed[j]}); j++;
  }
  return {res, tail:i};
}

/* RESET FUNCTION (KEY FIX) */
function resetToViewMode(){
  mode = "view";
  clearInterval(timer);
  timer = null;

  typingArea.style.display = "none";
  typingArea.value = "";

  textPanel.style.display = "block";

  startBtn.disabled = false;
  submitBtn.disabled = true;

  resultBox.style.display = "none";
  resultBox.innerHTML = "";

  keystrokes = 0;
  timerSpan.innerText = "Time Left: 10:00";
}

/* PASSAGE CHANGE */
document.getElementById("passageSelect").onchange = e => {
  if(e.target.value === "") return;
  resetToViewMode();
  textPanel.innerText = passages[e.target.value];
};

/* START TEST */
startBtn.onclick = () => {
  if(!textPanel.innerText.trim()) return;

  resetToViewMode();     // safety
  mode = "exam";

  typingArea.style.display = "block";
  textPanel.style.display = "none";
  typingArea.focus();

  startBtn.disabled = true;
  submitBtn.disabled = false;

  timeLeft = parseInt(timeSelect.value);
  updateTimer();

  timer = setInterval(() => {
    timeLeft--;
    updateTimer();
    if(timeLeft <= 0){
      clearInterval(timer);
      submitTest();
    }
  }, 1000);
};

/* KEYSTROKES */
typingArea.addEventListener("keydown", e => {
  if(e.key.length === 1 || e.key === "Backspace" || e.key === "Enter" || e.key === " "){
    keystrokes++;
  }
});

/* SUBMIT */
submitBtn.onclick = submitTest;

/* TIMER */
function updateTimer(){
  const m = Math.floor(timeLeft/60);
  const s = timeLeft % 60;
  timerSpan.innerText = `Time Left: ${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
}

/* SUBMIT LOGIC */
function submitTest(){
  if(mode !== "exam") return;
  mode = "result";
  clearInterval(timer);

  typingArea.style.display = "none";
  submitBtn.disabled = true;

  const given = splitWords(textPanel.innerText);
  const typed = splitWords(typingArea.value);
  const {res, tail} = alignAndClassify(given, typed);

  let html = "", correct = 0, wrong = 0;

  res.forEach(r => {
    if(r.t === "c"){
      html += `<span class="correct">${r.g}</span> `;
      correct++;
    } else if(r.t === "o"){
      html += `<span class="omitted">${r.g}</span> `;
      wrong++;
    } else {
      html += `<span class="wrong">${r.u}</span><span class="correct-word">(${r.g||""})</span> `;
      wrong++;
    }
  });

  for(let i = tail; i < given.length; i++){
    html += `<span class="blur">${given[i]}</span> `;
  }

  textPanel.style.display = "block";
  textPanel.innerHTML = html;

  const timeUsed = (parseInt(timeSelect.value) - timeLeft) || 1;
  const wpm = ((correct / timeUsed) * 60).toFixed(2);
  const kpm = ((keystrokes / timeUsed) * 60).toFixed(2);
  const accuracy = ((correct / (correct + wrong)) * 100).toFixed(2);

  resultBox.style.display = "block";
  resultBox.innerHTML = `
    <h3>Evaluation Summary</h3>
    <div class="summary-row"><span>Correct Words</span><span>${correct}</span></div>
    <div class="summary-row"><span>Incorrect Words</span><span>${wrong}</span></div>
    <div class="summary-row"><span>Accuracy</span><span>${accuracy} %</span></div>
    <div class="summary-row"><span>Keystrokes Typed</span><span>${keystrokes}</span></div>
    <div class="summary-row"><span>WPM</span><span>${wpm}</span></div>
    <div class="summary-row"><span>KPM</span><span>${kpm}</span></div>
  `;
}
</script>

</body>
</html>

